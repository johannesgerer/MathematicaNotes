(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     46428,       1264]
NotebookOptionsPosition[     45189,       1218]
NotebookOutlinePosition[     45558,       1234]
CellTagsIndexPosition[     45515,       1231]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Exit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.495782685822477*^9, 3.495782686555678*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrependTo", "[", 
   RowBox[{
   "$Path", ",", 
    "\"\<D:\\\\Users\\\\Johannes\\\\Promotion\\\\Mathematica\\\\Packages\>\""}\
], "]"}], ";", 
  RowBox[{"<<", "JoFin`"}]}]], "Input",
 CellChangeTimes->{{3.494701530641441*^9, 3.4947015362727633`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dS", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"r", " ", 
     RowBox[{"S", "[", "i", "]"}], " ", "dt"}], "+", 
    RowBox[{
     RowBox[{"\[Sigma]", "[", "i", "]"}], 
     RowBox[{"S", "[", "i", "]"}], " ", 
     RowBox[{"dB", "[", "i", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dP", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], "n"], 
     RowBox[{
      RowBox[{"q", "[", "i", "]"}], 
      RowBox[{"dS", "[", "i", "]"}]}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"P", " ", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "1"}], "n"], 
        RowBox[{
         RowBox[{"q", "[", "i", "]"}], 
         RowBox[{"S", "[", "i", "]"}]}]}]}], ")"}], "r", " ", "dt"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coef", "=", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"dP", ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"dB", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], ",", "dt"}], "]"}]}], 
     "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"n", "+", "1"}], "]"}], ":=", "P"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mm", "=", 
    RowBox[{"MMc", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coef", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"coef", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"n", "+", "2"}]}], "]"}], "]"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Resulting system of SDEs:\>\"", ",", 
    RowBox[{"MatrixForm", "/@", "mm"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mmd", "=", "mm"}], ";", 
  RowBox[{
   RowBox[{"MMdisc", "[", "mm", "]"}], "/", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], ",", "1"}], "}"}]}], "}"}], ",", "1"}],
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Resulting system of SDEs:\>\"", ",", 
    RowBox[{"MatrixForm", "/@", "mmd"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dfk", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{"FK", "[", 
    RowBox[{"V", ",", "mmd", ",", "r"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.495617167953808*^9, 3.4956171685848436`*^9}, 
   3.49578215987272*^9, {3.49578631468042*^9, 3.49578631472722*^9}, 
   3.4957867398716*^9, {3.495787098767641*^9, 3.4957871031356487`*^9}, {
   3.495787376182928*^9, 3.495787376260928*^9}, {3.4957980558433795`*^9, 
   3.49579805590578*^9}, {3.495798602824323*^9, 3.4957986036355247`*^9}, {
   3.4958060214856668`*^9, 3.4958061871871443`*^9}, {3.495806354548717*^9, 
   3.495806354616721*^9}, {3.495806563339659*^9, 3.495806564276713*^9}, {
   3.4958088372844577`*^9, 3.4958088399355636`*^9}, {3.4958090465880113`*^9, 
   3.4958090483780136`*^9}, {3.495809457752743*^9, 3.495809459052745*^9}, 
   3.4958118375007305`*^9, {3.4958197084021153`*^9, 3.495819716182126*^9}, {
   3.4958197678342004`*^9, 3.495819783134222*^9}, {3.495820007316538*^9, 
   3.4958201448827343`*^9}, {3.495820275198933*^9, 3.495820308600981*^9}, {
   3.4958208101400204`*^9, 3.4958208131800246`*^9}, {3.495820850860077*^9, 
   3.495820861692094*^9}, {3.4958208920121365`*^9, 3.49582094490221*^9}, {
   3.495821127742466*^9, 3.4958211298524694`*^9}, {3.4958211929725575`*^9, 
   3.495821251093639*^9}, {3.49582159823615*^9, 3.4958215986761503`*^9}, {
   3.4958216781382847`*^9, 3.4958216784382854`*^9}, {3.4958217120283327`*^9, 
   3.495821713128334*^9}, {3.4958219140306163`*^9, 3.4958219492306657`*^9}, {
   3.4958220639208264`*^9, 3.495822069310834*^9}, {3.4958221147808976`*^9, 
   3.4958221160908995`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dt", " ", "P", " ", "r"}], "+", 
  RowBox[{
   RowBox[{"dB", "[", "1", "]"}], " ", 
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"S", "[", "1", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "1", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.495820855570084*^9, 3.4958208620720944`*^9}, 
   3.4958208936421385`*^9, {3.4958209343021955`*^9, 3.49582094510221*^9}, 
   3.49582113039247*^9, {3.495821217823592*^9, 3.4958212513836393`*^9}, 
   3.4958215652861032`*^9, 3.4958215991061506`*^9, 3.4958216293672*^9, 
   3.495821678898286*^9, 3.4958217133483343`*^9, 3.4958219162606196`*^9, 
   3.495821949690666*^9, {3.4958220655208282`*^9, 3.4958221163208995`*^9}, 
   3.4958221729709787`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Resulting system of SDEs:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           RowBox[{"r", " ", 
            RowBox[{"S", "[", "1", "]"}]}]},
          {
           RowBox[{"P", " ", "r"}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{"S", "[", "1", "]"}], " ", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "0"},
         {
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], " ", 
           RowBox[{"S", "[", "1", "]"}], " ", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0"},
         {"0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "}"}]}],
  SequenceForm["Resulting system of SDEs:", {
    MatrixForm[{$CellContext`r $CellContext`S[
       1], $CellContext`P $CellContext`r}], 
    MatrixForm[{{$CellContext`S[1] $CellContext`\[Sigma][1], 
       0}, {$CellContext`q[1] $CellContext`S[1] $CellContext`\[Sigma][1], 
       0}}], 
    MatrixForm[{{1, 0}, {0, 1}}]}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.495820855580084*^9, 3.4958208620720944`*^9}, 
   3.4958208936421385`*^9, {3.4958209343021955`*^9, 3.4958209451122103`*^9}, 
   3.49582113040247*^9, {3.4958212178335924`*^9, 3.4958212513936396`*^9}, 
   3.4958215653061037`*^9, 3.4958215991061506`*^9, 3.495821629389201*^9, 
   3.495821678908286*^9, 3.4958217133483343`*^9, 3.4958219162606196`*^9, 
   3.495821949690666*^9, {3.4958220655308285`*^9, 3.4958221163308997`*^9}, 
   3.495822172980979*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   InterpretationBox[Cell[
    BoxData["\<\"The resulting system of SDEs:\"\>"], "Text", "TR"],
    Text["The resulting system of SDEs:"]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{"S", "[", "1", "]"}], " ", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "0"},
         {
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], " ", 
           RowBox[{"S", "[", "1", "]"}], " ", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0"},
         {"0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "}"}]}],
  SequenceForm[
   Text["The resulting system of SDEs:"], {
    MatrixForm[{0, 0}], 
    MatrixForm[{{$CellContext`S[1] $CellContext`\[Sigma][1], 
       0}, {$CellContext`q[1] $CellContext`S[1] $CellContext`\[Sigma][1], 
       0}}], 
    MatrixForm[{{1, 0}, {0, 1}}]}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.495820855580084*^9, 3.4958208620720944`*^9}, 
   3.4958208936421385`*^9, {3.4958209343021955`*^9, 3.4958209451122103`*^9}, 
   3.49582113040247*^9, {3.4958212178335924`*^9, 3.4958212513936396`*^9}, 
   3.4958215653061037`*^9, 3.4958215991061506`*^9, 3.495821629389201*^9, 
   3.495821678908286*^9, 3.4958217133483343`*^9, 3.4958219162606196`*^9, 
   3.495821949690666*^9, {3.4958220655308285`*^9, 3.4958221163308997`*^9}, 
   3.495822172980979*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Resulting system of SDEs:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           RowBox[{"r", " ", 
            RowBox[{"S", "[", "1", "]"}]}]},
          {
           RowBox[{"P", " ", "r"}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{"S", "[", "1", "]"}], " ", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "0"},
         {
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], " ", 
           RowBox[{"S", "[", "1", "]"}], " ", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0"},
         {"0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "}"}]}],
  SequenceForm["Resulting system of SDEs:", {
    MatrixForm[{$CellContext`r $CellContext`S[
       1], $CellContext`P $CellContext`r}], 
    MatrixForm[{{$CellContext`S[1] $CellContext`\[Sigma][1], 
       0}, {$CellContext`q[1] $CellContext`S[1] $CellContext`\[Sigma][1], 
       0}}], 
    MatrixForm[{{1, 0}, {0, 1}}]}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.495820855580084*^9, 3.4958208620720944`*^9}, 
   3.4958208936421385`*^9, {3.4958209343021955`*^9, 3.4958209451122103`*^9}, 
   3.49582113040247*^9, {3.4958212178335924`*^9, 3.4958212513936396`*^9}, 
   3.4958215653061037`*^9, 3.4958215991061506`*^9, 3.495821629389201*^9, 
   3.495821678908286*^9, 3.4958217133483343`*^9, 3.4958219162606196`*^9, 
   3.495821949690666*^9, {3.4958220655308285`*^9, 3.4958221163308997`*^9}, 
   3.495822172980979*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "r"}], " ", 
   RowBox[{"V", "[", 
    RowBox[{"t", ",", 
     RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}], "+", 
  RowBox[{"P", " ", "r", " ", 
   RowBox[{
    SuperscriptBox["V", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", 
     RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"q", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"S", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["V", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "2"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", 
     RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}], "+", 
  RowBox[{"r", " ", 
   RowBox[{"S", "[", "1", "]"}], " ", 
   RowBox[{
    SuperscriptBox["V", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", 
     RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"q", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"S", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["V", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", 
     RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"S", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["V", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "2", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", 
     RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["V", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t", ",", 
    RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.495820855570084*^9, 3.4958208620720944`*^9}, 
   3.4958208936421385`*^9, {3.4958209343021955`*^9, 3.49582094510221*^9}, 
   3.49582113039247*^9, {3.495821217823592*^9, 3.4958212513836393`*^9}, 
   3.4958215652861032`*^9, 3.4958215991061506`*^9, 3.4958216293672*^9, 
   3.495821678898286*^9, 3.4958217133483343`*^9, 3.4958219162606196`*^9, 
   3.495821949690666*^9, {3.4958220655208282`*^9, 3.4958221163208995`*^9}, 
   3.495822172980979*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"V3", ":=", 
   RowBox[{
    RowBox[{"#2", 
     RowBox[{"V", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"#3", "/", "#2"}]}], "]"}]}], "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4958215324960575`*^9, 3.4958215546660886`*^9}, {
  3.4958216195061793`*^9, 3.495821621306182*^9}, {3.4958219252806325`*^9, 
  3.4958219258506327`*^9}, {3.4958221202309055`*^9, 3.4958221214709067`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dfk", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DFK", "[", 
      RowBox[{"V3", ",", "mmd"}], "]"}], "/", 
     RowBox[{"S", "[", "1", "]"}]}], "/.", 
    RowBox[{"P", "\[Rule]", 
     RowBox[{"P", " ", 
      RowBox[{"S", "[", "1", "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.4958215623260994`*^9, {3.4958218304484987`*^9, 3.495821878780567*^9}, {
   3.4958219283606367`*^9, 3.4958219291406374`*^9}, {3.495821966110689*^9, 
   3.4958219685906925`*^9}, 3.495822048220804*^9, {3.4958221352309265`*^9, 
   3.495822142250936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", 
   RowBox[{"V", "[", 
    RowBox[{"t", ",", "P"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["P", "2"], " ", 
   SuperscriptBox[
    RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["V", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "2"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "P"}], "]"}]}], "-", 
  RowBox[{"P", " ", 
   RowBox[{"q", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["V", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "2"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "P"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"q", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["V", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "2"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "P"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["V", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t", ",", "P"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.495821566576105*^9, {3.4958216226161833`*^9, 3.4958216314982195`*^9}, 
   3.4958216808982887`*^9, {3.495821831550501*^9, 3.4958218790805674`*^9}, 
   3.495821929330638*^9, {3.49582195950068*^9, 3.4958219690606937`*^9}, {
   3.495822048680805*^9, 3.4958220751908417`*^9}, {3.495822122940909*^9, 
   3.4958221427409368`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"CoefficientArrays", "[", 
   RowBox[{"dfk", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"q", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", 
    RowBox[{"Symmetric", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.4958117255505733`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "r"}], " ", 
      RowBox[{"V", "[", 
       RowBox[{"t", ",", 
        RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}], "+", 
     RowBox[{"P", " ", "r", " ", 
      RowBox[{
       SuperscriptBox["V", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", 
        RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"S", "[", "1", "]"}], " ", 
      RowBox[{
       SuperscriptBox["V", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", 
        RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"S", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["V", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", 
        RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["V", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", 
       RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          SuperscriptBox[
           RowBox[{"S", "[", "1", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["V", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"t", ",", 
            RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
      SparseArray[
      Automatic, {1}, 0, {
       1, {{0, 1}, {{1}}}, {$CellContext`S[1]^2 $CellContext`\[Sigma][1]^2 
         Derivative[0, 1, 1][$CellContext`V][$CellContext`t, 
           $CellContext`S[1], $CellContext`P]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"S", "[", "1", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", 
           RowBox[{"S", "[", "1", "]"}], ",", "P"}], "]"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {1, 1}, 0, {
       1, {{0, 1}, {{1}}}, {
        Rational[1, 2] $CellContext`S[1]^2 $CellContext`\[Sigma][1]^2 
         Derivative[
          0, 0, 2][$CellContext`V][$CellContext`t, $CellContext`S[
           1], $CellContext`P]}}]]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4957881035619106`*^9, 3.495788468493352*^9, {3.495797261619952*^9, 
   3.495797276315178*^9}, {3.4957980463657303`*^9, 3.4957980613345895`*^9}, 
   3.4957986110299377`*^9, 3.4958058773024197`*^9, 3.4958062107374916`*^9, 
   3.495806474133557*^9, 3.495809076688053*^9, 3.4958094631347513`*^9, 
   3.4958117261005745`*^9, 3.495811839960735*^9, 3.4958203130509872`*^9, 
   3.4958209059721556`*^9, 3.4958218803905697`*^9, 3.4958219703806953`*^9, {
   3.495822051520809*^9, 3.49582209511087*^9}, 3.495822143950938*^9, 
   3.4958221774709854`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["constant volatility", "Section",
 CellChangeTimes->{{3.4957861383186502`*^9, 3.495786141391856*^9}, {
   3.495786228802269*^9, 3.4957862426706934`*^9}, 3.495797262119153*^9, {
   3.4957980468025312`*^9, 3.495798048424934*^9}}],

Cell["\<\
The option value will be independent of the asset prices, as can be veryfied \
by the absence of S terms in the following equation:\
\>", "Text",
 CellChangeTimes->{{3.4957862534971123`*^9, 3.4957863012643967`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"V2", ":=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<V[#1,#\>\"", ",", 
      RowBox[{"ToString", "[", 
       RowBox[{"n", "+", "2"}], "]"}], ",", "\"\<]&\>\""}], "]"}], "]"}]}], 
  ";", 
  RowBox[{"dfkC", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"DFK", "[", 
     RowBox[{"V2", ",", "mm"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495611976935749*^9, 3.49561199209577*^9}, {
   3.4956121518459935`*^9, 3.495612151975994*^9}, {3.4956145795146933`*^9, 
   3.4956145889747066`*^9}, {3.495614816275025*^9, 3.495614822735034*^9}, {
   3.4956154287875957`*^9, 3.4956154313375998`*^9}, 3.495615523877729*^9, {
   3.495615622561531*^9, 3.4956156350715485`*^9}, 3.495615953003026*^9, {
   3.495616010223106*^9, 3.4956160160431137`*^9}, {3.4956160482031593`*^9, 
   3.4956160488031597`*^9}, {3.495616172252236*^9, 3.4956162042522807`*^9}, {
   3.495616260312359*^9, 3.4956162613523607`*^9}, {3.4956173258008356`*^9, 
   3.4956173263208656`*^9}, {3.4956173918416133`*^9, 3.4956173946167717`*^9}, 
   3.4956174371852064`*^9, 3.4956209146834116`*^9, 3.4956210966594653`*^9, {
   3.4956223847220564`*^9, 3.495622407592088*^9}, {3.4956225657723093`*^9, 
   3.495622569732315*^9}, {3.4956226033823624`*^9, 3.4956226041523633`*^9}, {
   3.495626519488845*^9, 3.4956265363488684`*^9}, {3.4957816320291924`*^9, 
   3.495781632387993*^9}, {3.495782749782589*^9, 3.4957827974094725`*^9}, {
   3.49578637742373*^9, 3.495786396674164*^9}, {3.4957865778809156`*^9, 
   3.4957865809541206`*^9}, {3.4957866731034827`*^9, 3.495786728795581*^9}, 
   3.4957880828918743`*^9, {3.4958198215842752`*^9, 3.495819831596292*^9}, 
   3.4958203232010016`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"P", " ", "r", " ", 
   RowBox[{
    SuperscriptBox["V", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "P"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"q", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["V", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "2"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "P"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["V", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t", ",", "P"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.4956119923757706`*^9, 3.495612152185994*^9, {3.495612188296045*^9, 
   3.495612192716051*^9}, {3.495612275776167*^9, 3.495612290776188*^9}, 
   3.495612670437753*^9, {3.495612751847867*^9, 3.495612803247939*^9}, 
   3.495614582894698*^9, {3.4956148198250294`*^9, 3.495614822995034*^9}, {
   3.4956154337176027`*^9, 3.4956154542176313`*^9}, {3.4956155256377316`*^9, 
   3.4956155378577485`*^9}, {3.495615623351532*^9, 3.4956156353115487`*^9}, 
   3.4956157808117847`*^9, 3.495615838561866*^9, {3.4956158938629427`*^9, 
   3.4956159617630377`*^9}, {3.4956160108531065`*^9, 3.495616016703115*^9}, 
   3.495616049323161*^9, {3.495616176632242*^9, 3.495616204502281*^9}, {
   3.495616261662361*^9, 3.4956162939824066`*^9}, {3.4956173085208473`*^9, 
   3.49561732640287*^9}, {3.495617437671234*^9, 3.4956174520620575`*^9}, 
   3.495617484111891*^9, 3.495619241307384*^9, 3.4956209153174477`*^9, 
   3.4956210445293922`*^9, 3.4956210968894653`*^9, 3.4956224078320885`*^9, 
   3.49562256606231*^9, 3.4956226043423634`*^9, 3.4956229008127785`*^9, {
   3.495623896634173*^9, 3.495623907064187*^9}, 3.4956245062360263`*^9, 
   3.495625601057559*^9, {3.4956265231588497`*^9, 3.495626536758869*^9}, 
   3.495781597942133*^9, 3.4957816325907936`*^9, {3.495782759298606*^9, 
   3.4957827977682734`*^9}, 3.4957835263941903`*^9, 3.495786325647239*^9, {
   3.495786378453332*^9, 3.495786397110965*^9}, 3.4957865001927795`*^9, {
   3.4957866744294853`*^9, 3.4957867486856155`*^9}, 3.495787239448688*^9, 
   3.4957880203825645`*^9, 3.495788085497079*^9, {3.4957972514799347`*^9, 
   3.495797279107583*^9}, {3.4957980501745577`*^9, 3.495798062910192*^9}, 
   3.49579861243394*^9, {3.4958198001142454`*^9, 3.4958198595463314`*^9}, 
   3.4958203238910027`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"coef", "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"dfkC", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"q", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"Symmetric", "\[Rule]", "True"}]}], "]"}]}], ";", 
  RowBox[{"MatrixForm", "/@", "coef"}]}]], "Input",
 CellChangeTimes->{{3.4957816216863747`*^9, 3.4957816634174476`*^9}, {
   3.495782122432654*^9, 3.4957821359578776`*^9}, {3.495783550531571*^9, 
   3.495783560155121*^9}, 3.4957880842022767`*^9, {3.4957972917280045`*^9, 
   3.4957973004484205`*^9}, {3.495797443110671*^9, 3.495797472329522*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{
     SuperscriptBox["V", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "P"}], "]"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
      SparseArray[Automatic, {4}, 0, {1, {{0, 0}, {}}, {}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"1", ",", "2"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "3", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"1", ",", "4"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "4", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}]},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"1", ",", "2"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"2", ",", "3"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "3", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"2", ",", "4"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "4", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}]},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "3", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"2", ",", "3"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "3", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Sigma]", "[", "3", "]"}], "2"], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"3", ",", "4"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "3", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "4", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}]},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"1", ",", "4"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "4", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"2", ",", "4"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "4", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"3", ",", "4"}], "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "3", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "4", "]"}], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Sigma]", "[", "4", "]"}], "2"], " ", 
         RowBox[{
          SuperscriptBox["V", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "P"}], "]"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 4, 8, 12, 16}, {{2}, {1}, {4}, {3}, {2}, {3}, {1}, {4}, {3}, {
         4}, {1}, {2}, {1}, {4}, {2}, {3}}}, {
        Rational[1, 2] $CellContext`\[Rho][1, 2] $CellContext`\[Sigma][
          1] $CellContext`\[Sigma][2] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Sigma][1]^2 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][1, 4] $CellContext`\[Sigma][
          1] $CellContext`\[Sigma][4] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][1, 3] $CellContext`\[Sigma][
          1] $CellContext`\[Sigma][3] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Sigma][2]^2 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][2, 3] $CellContext`\[Sigma][
          2] $CellContext`\[Sigma][3] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][1, 2] $CellContext`\[Sigma][
          1] $CellContext`\[Sigma][2] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][2, 4] $CellContext`\[Sigma][
          2] $CellContext`\[Sigma][4] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Sigma][3]^2 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][3, 4] $CellContext`\[Sigma][
          3] $CellContext`\[Sigma][4] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][1, 3] $CellContext`\[Sigma][
          1] $CellContext`\[Sigma][3] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][2, 3] $CellContext`\[Sigma][
          2] $CellContext`\[Sigma][3] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][1, 4] $CellContext`\[Sigma][
          1] $CellContext`\[Sigma][4] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Sigma][4]^2 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][2, 4] $CellContext`\[Sigma][
          2] $CellContext`\[Sigma][4] 
         Derivative[0, 2][$CellContext`V][$CellContext`t, $CellContext`P], 
         Rational[1, 2] $CellContext`\[Rho][3, 4] $CellContext`\[Sigma][
          3] $CellContext`\[Sigma][4] 
         Derivative[
          0, 2][$CellContext`V][$CellContext`t, $CellContext`P]}}]]]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.4957816390024047`*^9, 3.495781663620248*^9}, {
   3.4957821256306596`*^9, 3.4957821362698784`*^9}, 3.495783529253354*^9, 
   3.495783561371191*^9, 3.4957863268640413`*^9, 3.4957863989205675`*^9, 
   3.495786501253581*^9, 3.4957867497308173`*^9, 3.495787279400358*^9, 
   3.495788021427767*^9, 3.4957880879462833`*^9, {3.4957972526655364`*^9, 
   3.4957973013376217`*^9}, {3.495797449912283*^9, 3.495797472610323*^9}, {
   3.495798050866971*^9, 3.495798063580993*^9}, 3.4957986129175406`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1009, 846},
WindowMargins->{{60, Automatic}, {Automatic, 71}},
CellContext->Notebook,
FrontEndVersion->"7.0 for Microsoft Windows (64-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 118, 2, 31, "Input"],
Cell[666, 24, 286, 8, 31, "Input"],
Cell[CellGroupData[{
Cell[977, 36, 4298, 111, 240, "Input"],
Cell[5278, 149, 717, 14, 30, "Output"],
Cell[CellGroupData[{
Cell[6020, 167, 3291, 82, 36, "Print"],
Cell[9314, 251, 3240, 82, 36, "Print"],
Cell[12557, 335, 3291, 82, 36, "Print"]
}, Open  ]],
Cell[15863, 420, 2893, 90, 83, "Output"]
}, Open  ]],
Cell[18771, 513, 422, 10, 31, "Input"],
Cell[CellGroupData[{
Cell[19218, 527, 592, 15, 31, "Input"],
Cell[19813, 544, 1753, 57, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21603, 606, 372, 10, 31, "Input"],
Cell[21978, 618, 5007, 140, 74, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27022, 763, 232, 3, 71, "Section"],
Cell[27257, 768, 225, 4, 29, "Text"],
Cell[CellGroupData[{
Cell[27507, 776, 1717, 30, 31, "Input"],
Cell[29227, 808, 2620, 57, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31884, 870, 685, 15, 31, "Input"],
Cell[32572, 887, 12589, 327, 186, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

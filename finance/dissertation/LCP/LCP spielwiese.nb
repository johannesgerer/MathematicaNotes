(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     46432,       1127]
NotebookOptionsPosition[     45089,       1081]
NotebookOutlinePosition[     45433,       1096]
CellTagsIndexPosition[     45390,       1093]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"CheckSuffMProperty", "[", "A0_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "=", "A0"}], ",", 
      RowBox[{"B", "=", 
       RowBox[{"A0", "-", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Diagonal", "[", "A0", "]"}], "]"}]}]}], ",", 
      RowBox[{"M", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"-", 
           RowBox[{"Diagonal", "[", "A", "]"}]}], "]"}], "]"}], ">", "0"}], 
       ",", 
       RowBox[{
        RowBox[{"M", "=", "0"}], ";", 
        RowBox[{"Print", "[", "\"\<Diagonal <= 0\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"1", "-", 
          RowBox[{"UnitStep", "[", 
           RowBox[{"-", 
            RowBox[{"Flatten", "[", "B", "]"}]}], "]"}]}], "]"}], ">", "0"}], 
       ",", 
       RowBox[{
        RowBox[{"M", "=", "0"}], ";", 
        RowBox[{"Print", "[", "\"\<Off-Diagonal > 0\>\"", "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Tally", "[", 
            RowBox[{"Sign", "[", 
             RowBox[{"Total", "[", 
              RowBox[{"Transpose", "[", "A", "]"}], "]"}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "1"}], "&&", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Tally", "[", 
           RowBox[{"Sign", "[", 
            RowBox[{"Total", "[", "A", "]"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"M", "=", "0"}], ";", 
        RowBox[{"Print", "[", "\"\<Not Diagonally Dominant\>\"", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5038410802737083`*^9, 3.503841084329715*^9}, {
   3.5038490052646313`*^9, 3.5038490133766456`*^9}, {3.5038491569748983`*^9, 
   3.5038491583009005`*^9}, {3.5038492352558355`*^9, 3.503849240357044*^9}, {
   3.503849289521163*^9, 3.5038493021883855`*^9}, 3.503849614263797*^9, 
   3.503850072878008*^9, 3.5038525719441357`*^9, {3.5038535209794173`*^9, 
   3.5038535467858934`*^9}, 3.503853661784471*^9, 3.5038558977383604`*^9, {
   3.503857398955225*^9, 3.503857399146236*^9}, 3.503857624707137*^9, 
   3.5038582863309803`*^9, 3.5038586453635154`*^9, {3.5038599524012737`*^9, 
   3.5038599533523283`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LCPiterate", "[", 
    RowBox[{
    "M0_", ",", "q0_", ",", "x0_", ",", "t0_", ",", "norm0_", ",", 
     "LCPsolver_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"Iterative", " ", "LCP", " ", "Solver"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "=", "M0"}], ",", 
       RowBox[{"q", "=", "q0"}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "x0", "]"}]}], ",", 
       RowBox[{"norm", "=", "norm0"}], ",", 
       RowBox[{"x", "=", "x0"}], ",", 
       RowBox[{"tol", "=", "t0"}], ",", 
       RowBox[{"notDone", "=", "True"}], ",", 
       RowBox[{"d", "=", 
        RowBox[{
         RowBox[{"M0", ".", "x0"}], "-", "q0"}]}], ",", 
       RowBox[{"LCP", "=", "LCPsolver"}], ",", "i", ",", 
       RowBox[{"xm", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"notDone", "||", 
         RowBox[{
          RowBox[{"Min", "[", "d", "]"}], "<", 
          RowBox[{
           RowBox[{"-", "tol"}], " ", "xm"}]}], "||", 
         RowBox[{
          RowBox[{"Min", "[", "x", "]"}], "<", 
          RowBox[{
           RowBox[{"-", "tol"}], " ", "xm"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<LCP iteration\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Timing", "[", 
            RowBox[{
             RowBox[{"x", "=", 
              RowBox[{"LCPsolver", "[", 
               RowBox[{"M", ",", "q", ",", "d", ",", "x"}], "]"}]}], ";"}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Check", " ", "for", " ", "termination"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{
           RowBox[{"M", ".", "x"}], "-", "q"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xm", "=", 
          RowBox[{"Norm", "[", 
           RowBox[{"x", ",", "norm"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"i", "=", "1"}], ";", 
         RowBox[{"notDone", "=", "False"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", "notDone"}], " ", "&&", 
            RowBox[{"i", "\[LessEqual]", "n"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"notDone", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", 
               RowBox[{"tol", " ", "xm"}]}], " ", "&&", 
              StyleBox[" ", "OperatorCharacter"], 
              RowBox[{
               RowBox[{
                StyleBox["Abs", "OperatorCharacter"], 
                StyleBox["[", "OperatorCharacter"], 
                StyleBox[
                 RowBox[{"x", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "OperatorCharacter"], "]"}],
                ">", 
               RowBox[{"tol", " ", "xm"}]}]}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"notDone", ",", 
                RowBox[{"Print", "[", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "/", "bm"}], ",", 
                   RowBox[{
                    RowBox[{
                    StyleBox["Abs", "OperatorCharacter"], 
                    StyleBox["[", "OperatorCharacter"], 
                    RowBox[{
                    StyleBox[
                    RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "OperatorCharacter"], "-", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/", " ", 
                    "cm"}]}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Min", "[", "d", "]"}], "/", "bm"}], ",", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"x", "-", "c"}], "]"}], "/", "cm"}]}], "}"}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "x"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"M", ".", "x"}], "-", "q"}], ",", "x"}], "}"}], "]"}], 
     "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5038590597742186`*^9, 3.503859175696849*^9}, {
   3.503859227375805*^9, 3.5038593899501033`*^9}, {3.503859437846843*^9, 
   3.503859485231553*^9}, {3.5038595677442727`*^9, 3.5038595683913097`*^9}, 
   3.5038596433515973`*^9, {3.5038598664653587`*^9, 3.503859905642599*^9}, {
   3.5038599565385103`*^9, 3.5038599571585455`*^9}, {3.5038602004004583`*^9, 
   3.5038602379536066`*^9}, {3.503860736362114*^9, 3.5038607437135344`*^9}, {
   3.5038671639957533`*^9, 3.5038671945475006`*^9}, {3.5038673343594975`*^9, 
   3.503867334710518*^9}, {3.503867579619526*^9, 3.5038675856108685`*^9}, {
   3.503867822605424*^9, 3.503867891042338*^9}, {3.5038680063949356`*^9, 
   3.5038680615310893`*^9}, {3.503868095898055*^9, 3.503868096442086*^9}, {
   3.503868129178959*^9, 3.503868146185931*^9}, {3.5038682513769484`*^9, 
   3.5038682812086544`*^9}, {3.5038685826418953`*^9, 3.503868585785075*^9}, {
   3.503868899233003*^9, 3.503868925809523*^9}, {3.503868960985535*^9, 
   3.5038689982646675`*^9}, {3.503870006185317*^9, 3.503870022785267*^9}, {
   3.5041992769736443`*^9, 3.5041992802028503`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PIM", "[", 
    RowBox[{"M0_", ",", "q0_", ",", "d0_", ",", "x0_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"Policy", " ", "Iteration", " ", "Method"}], "*)"}], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "=", "M0"}], ",", 
       RowBox[{"q", "=", "q0"}], ",", 
       RowBox[{"d", "=", "d0"}], ",", 
       RowBox[{"x", "=", "x0"}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "x0", "]"}]}], ",", "i", ",", "k"}], "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "-=", "x"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"Timing", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Construct", " ", "the", " ", "Matrix", " ", "for", " ", "the", " ",
            "current", " ", "iteration"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", "n"}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"d", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", " ", 
                  RowBox[{"k", "\[LessEqual]", "n"}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"i", ",", "k"}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"q", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"Timing", "[", 
         RowBox[{
          RowBox[{"x", "=", 
           RowBox[{"LinearSolve", "[", 
            RowBox[{"M", ",", "q"}], "]"}]}], ";"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      "x"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5038494964794464`*^9, 3.503849554207958*^9}, {
   3.5038496073529844`*^9, 3.5038496190686054`*^9}, {3.503849792447769*^9, 
   3.503849812119404*^9}, {3.503850102086692*^9, 3.5038501383632107`*^9}, {
   3.5038502374136057`*^9, 3.5038502421250772`*^9}, {3.5038516271340957`*^9, 
   3.5038516475022607`*^9}, {3.503851798949923*^9, 3.503851831686795*^9}, {
   3.503851862942583*^9, 3.5038519070941086`*^9}, {3.503851946142342*^9, 
   3.5038520287240653`*^9}, {3.503852165935913*^9, 3.503852192735446*^9}, {
   3.5038522560640683`*^9, 3.503852283592643*^9}, {3.503852356368806*^9, 
   3.5038526462743874`*^9}, {3.5038526861466675`*^9, 3.503852778288938*^9}, {
   3.5038530271531725`*^9, 3.5038531494491673`*^9}, {3.5038531858032465`*^9, 
   3.503853201338135*^9}, {3.5038532874590607`*^9, 3.5038532910502663`*^9}, {
   3.503853356554013*^9, 3.503853451689454*^9}, {3.5038535710972843`*^9, 
   3.5038536415303125`*^9}, {3.5038536833067017`*^9, 3.503853719482771*^9}, {
   3.503853783498433*^9, 3.5038538687633095`*^9}, {3.503853899067043*^9, 
   3.50385394692378*^9}, {3.5038539983647223`*^9, 3.5038541851964083`*^9}, {
   3.5038542344132233`*^9, 3.50385426844517*^9}, {3.503854308900484*^9, 
   3.503854402587843*^9}, {3.5038544554448657`*^9, 3.503854487579704*^9}, {
   3.5038545585907655`*^9, 3.5038546105727386`*^9}, {3.503854664998852*^9, 
   3.5038547425342865`*^9}, {3.5038547771662674`*^9, 3.503854823614924*^9}, {
   3.503855053824091*^9, 3.5038550932753477`*^9}, {3.503855129389413*^9, 
   3.503855284361277*^9}, {3.5038553379843445`*^9, 3.503855338640382*^9}, {
   3.5038553867281322`*^9, 3.5038554143067093`*^9}, {3.5038555402589135`*^9, 
   3.503855634358296*^9}, {3.503855683838126*^9, 3.503855725190491*^9}, {
   3.50385625055054*^9, 3.5038564597675066`*^9}, {3.5038565068471994`*^9, 
   3.503856507751251*^9}, {3.5038565622563686`*^9, 3.503856655184684*^9}, {
   3.503856727920844*^9, 3.503856736816353*^9}, {3.503856785784154*^9, 
   3.503856849034771*^9}, {3.503856972857854*^9, 3.503856977181101*^9}, {
   3.5038570082978806`*^9, 3.503857110444723*^9}, {3.5038571453157177`*^9, 
   3.5038573612200665`*^9}, {3.5038573936669226`*^9, 3.503857450166154*^9}, {
   3.503857492489575*^9, 3.503857496304793*^9}, {3.503857542254421*^9, 
   3.5038577900935965`*^9}, {3.503857881690836*^9, 3.5038578879781957`*^9}, {
   3.5038582027652006`*^9, 3.503858210268629*^9}, {3.5038582733892393`*^9, 
   3.503858283568822*^9}, {3.503858616809882*^9, 3.503858638954149*^9}, {
   3.503858705178937*^9, 3.50385870575797*^9}, {3.5038589084415627`*^9, 
   3.5038589352090936`*^9}, {3.503858967296929*^9, 3.503858968904021*^9}, {
   3.5038590158377056`*^9, 3.5038590245962067`*^9}, 3.503859209956808*^9, {
   3.5038593978035526`*^9, 3.503859433687605*^9}, {3.503859493638034*^9, 
   3.5038596117627907`*^9}, {3.503859924217662*^9, 3.5038599247846937`*^9}, {
   3.5038600035692005`*^9, 3.5038600313557897`*^9}, {3.5038601581410418`*^9, 
   3.5038601800522947`*^9}, {3.5038602465330973`*^9, 3.503860322229427*^9}, {
   3.5038605415809727`*^9, 3.5038606056206355`*^9}, {3.5038606370374327`*^9, 
   3.5038606860772376`*^9}, {3.5038683494685583`*^9, 3.503868352891754*^9}, {
   3.503868408435931*^9, 3.503868481259096*^9}, {3.503868717141588*^9, 
   3.503868779036128*^9}, {3.5038688092358556`*^9, 3.5038688171473083`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Generation", " ", "of", " ", "a", " ", "some", " ", "random", " ", "M"}],
     "-", "Matrix"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"-", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"10", ",", 
          RowBox[{"n", "-", "1"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"10", ",", 
          RowBox[{"n", "-", "1"}]}], "]"}]}], ",", 
       RowBox[{"{", "0", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", 
     RowBox[{
      RowBox[{"-", "b"}], "-", "c", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"0", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"5", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"RandomReal", "[", 
              RowBox[{"1", ",", "n"}], "]"}], "-", "0.6"}], ")"}]}], ")"}]}], 
        "^", "2"}], ")"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.503869311663593*^9, 3.5038693786874266`*^9}, 
   3.5038701441602087`*^9, {3.504264217211211*^9, 3.5042642173782206`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M1", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "i_"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"a", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"i", "-", "j"}], "\[Equal]", "1"}]}], "\[RuleDelayed]", 
        RowBox[{"b", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"j", "-", "i"}], "\[Equal]", "1"}]}], "\[RuleDelayed]", 
        RowBox[{"c", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M2", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", "2.1"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"i", "-", "j"}], "\[Equal]", 
          RowBox[{"-", "1"}]}]}], "\[Rule]", 
        RowBox[{"-", "1.0"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"i", "-", "j"}], "\[Equal]", 
          RowBox[{"-", "1"}]}]}], "\[Rule]", 
        RowBox[{"-", "1.01"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CheckSuffMProperty", "[", "M1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckSuffMProperty", "[", "M2", "]"}], "\n", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"2", ",", "n"}], "]"}]}], ";", 
  RowBox[{"q", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"Sin", "[", 
         RowBox[{"20", " ", 
          RowBox[{"i", "/", "n"}]}], "]"}]}], "+", 
       RowBox[{"PolyLog", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "/", "n"}]}], "-", "1"}]}], 
        "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{"x", ",", "q"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5038586952223673`*^9, 3.503858703773856*^9}, {
   3.503859705102129*^9, 3.5038597679507236`*^9}, {3.503859942589712*^9, 
   3.503859976270639*^9}, {3.5038600362310686`*^9, 3.5038600363260736`*^9}, {
   3.503860182366427*^9, 3.5038601831424713`*^9}, {3.5038607659028034`*^9, 
   3.5038608388069735`*^9}, {3.5038679736480627`*^9, 3.5038679738000717`*^9}, 
   3.503868072944742*^9, {3.503868890518505*^9, 3.5038688936056814`*^9}, {
   3.5038690095253115`*^9, 3.503869301249997*^9}, 3.5038693886019936`*^9, {
   3.5038694341125965`*^9, 3.5038694468743267`*^9}, {3.5038695587477255`*^9, 
   3.503869571351446*^9}, {3.503869834329488*^9, 3.5038698543236313`*^9}, {
   3.5038699552204027`*^9, 3.503869960918728*^9}, {3.504264309715502*^9, 
   3.504264383894745*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.503869931617052*^9, 3.5038699859991627`*^9}, 
   3.503870145664295*^9, 3.5041992627464194`*^9, 3.50426421981536*^9, {
   3.50426436107644*^9, 3.5042643842597656`*^9}, 3.5042644143594875`*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.503869931617052*^9, 3.5038699859991627`*^9}, 
   3.503870145664295*^9, 3.5041992627464194`*^9, 3.50426421981536*^9, {
   3.50426436107644*^9, 3.5042643842597656`*^9}, 3.5042644143614874`*^9}],

Cell[BoxData[
 GraphicsBox[{
   {Hue[0.67, 0.6, 0.6], 
    PointBox[{{1., 0.5414196136138947}, {2., 0.21764825377008412`}, {3., 
     0.6136047993179061}, {4., 1.9104025052777223`}, {5., 
     1.4604928907377648`}, {6., 1.4728019434766404`}, {7., 
     0.8287557629134912}, {8., 1.2869297147915981`}, {9., 
     0.4630798611749416}, {10., 0.6276358683490031}}]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], 
    PointBox[{{1., 1.3185948536513634`}, {2., -1.9580494350603008`}, {
     3., -0.9338309963978517}, {4., 1.6930022075324778`}, {
     5., -1.2547088884454063`}, {6., -1.0731458360008699`}, {7., 
     2.2312147113897405`}, {8., 0.09086003333653603}, {
     9., -0.001974493543352329}, {10., 5.825890501455255}}]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, Automatic},
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.503869931617052*^9, 3.5038699859991627`*^9}, 
   3.503870145664295*^9, 3.5041992627464194`*^9, 3.50426421981536*^9, {
   3.50426436107644*^9, 3.5042643842597656`*^9}, 3.5042644143854885`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "100"}], ";", 
  RowBox[{"q", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"0.1", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"z", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"0.005", " ", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"M2", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", 
        RowBox[{
         RowBox[{"i", "^", "0.3"}], "*", "2.0"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"i", "-", "j"}], "\[Equal]", 
          RowBox[{"-", "1"}]}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "0.5"}], 
         RowBox[{"j", "^", "0.3"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"i", "-", "j"}], "\[Equal]", "1"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "0.5"}], "+", 
         RowBox[{"0.9", 
          RowBox[{"Sin", "[", "i", "]"}]}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5042642569924865`*^9, 3.504264291696471*^9}, {
  3.504264388032982*^9, 3.504264465187394*^9}, {3.5042645800029616`*^9, 
  3.5042645819950757`*^9}, {3.504273671683976*^9, 3.5042736925321684`*^9}, {
  3.504273808091778*^9, 3.5042738262848186`*^9}, {3.504279632704665*^9, 
  3.504279771888109*^9}, {3.5042798796998987`*^9, 3.504279881119501*^9}, {
  3.5042799149559608`*^9, 3.504279941429207*^9}, {3.504279975952068*^9, 
  3.5042799784636726`*^9}, {3.5042801235782404`*^9, 3.504280130754253*^9}, {
  3.5042806388109736`*^9, 3.504280666922223*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.504280663989418*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"M2", ".", "a2"}], "-", "q"}], ",", "a2"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5042797982053556`*^9, 3.5042798282042084`*^9}, {
  3.5042798935839233`*^9, 3.504279904815943*^9}, {3.504279948059219*^9, 
  3.5042799627856445`*^9}, {3.504280383188925*^9, 3.504280422516594*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {Hue[0.67, 0.6, 0.6], PointBox[CompressedData["
1:eJxdlF9IU3EUx9ciEDMSKyomaWIhYdZctXKaZ+p0/t/uzK0oClkRPdRi0oNE
3F588CGCJKuHmtFr/slIHAr3QVpKhL6kD4pbRlTO1MqnHlZxv0e458D48dnn
nPP7XX7n3v1tN5TLZpPJFPz3+7/qsVqur6FS/EH6ch+cRiZDZLIf1ded4AHw
HpGfLTgXHEH/POHzhT8ofIHY75DwhVwPXyT6HeV6sFXUF4v+NuGPCT4u9jsh
vB2swZ8U/pSoLxHndQguFfVlYBX+NDP6lYMvwRNttqT3b5t7qd+7StSTMTxp
to5jDpzU3pDKnDg3Be+knLboHUf4I3wFrU2vVjqVOfgKclqKktd+x+ErKaIl
U63di/CV9GEo53CR+Qt8FfXtm5sfsX+Fr6Kxd586fEe+w7toNmtq4efiEryL
DnRtKnF4l+GrabXAZe0M/4CvJpViZcs1K/A1FE1e2OF9D1ZrSEnat19MsXdT
qizjSXecvZteLOXdohD7WrI9jq/f7ef+tTSSN5tdHeH962gmP/qqwpWEryN7
1mjLSi+fv55CW4p7bkf5+erJP5DeNPGAn7+BXq8/3N1q+wzfQJFYR639WQK+
kSYX7sXSR+fhG8kytjX4aHkGvom05wNda4lp+CY6/8c2s9cbg2+mcP3Nb91p
g/DNuH8ODxjzQRusz4fqMeZrzPw98BqZmDG/qmCNmUMxehKsKsZ8jZnfV5+o
F6z6jPnahkd9i6hvMXqVGe+/JvJNZ4yemBEqM/ppG/nYv9XoiZnrBWvM/L31
g/n+/MZ8ldmD8/upThmPuK8MYT4CVDC8K83veaszBSjcO9jXGeR5CpD5+lA8
2I550wIUepPbW+XGPJrOktL8a/3p1UT5X9ntETU=
     "]]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], PointBox[CompressedData["
1:eJxd1HtMjWEcB/Anx3LbGdJymQhHiSQplXC+LhWp45zT6Zwyt1JIm5g0cjvm
WG0ojOgPmq7G2c7JJdc6hyOSW5JYVLJh2MoshuU6v7fxe7d37z7vd9/neS/P
+45KTNMm9xBCJP3e/xz/bh+UHl8XVbTWVSjpBDZtPOwIUtnJvZFVMG2JJbmW
PABV+N70dOMjsisWlZT7bL7fSB4Cy7xvb3ZkSflwRPS752ZR3Sd7wF3Tuj/7
7QPyaIQkTtDGhTaQFQhL7lhcMbiJ7IkN6zaZ3mU0k8eh6HjTEpWzlI/HNZtK
5HXP5wPdbkdbV8lDsi+qt5+Ma+mUcj9EpVx+c6jXU/JkVIYbVqXbpPH8Ya7v
t9MUJuVToLhak1TZJY0XgCGfEsWT0rvkQERe9w5yeSJ5Ktoz2rIS+tSRgyDT
OhrqJ0r9YIyJ1vfa/V56HiHY43miYXVHNXkaCrfOLDNpKsmhWPZlf+PHxgvk
6ZgU+Wxy16Hz5BkYW2Q622I6Q56JNP2+8ev9T5KVKCxzCba655AB8e9mZBaz
WM4sZrOcWcxhObOYy3JmEcZyZhHOcmYRwXJmMY/lzGI+y5lFJMuZxQKWM4so
ljOLaJYzCxXLmcVCli9EPRbveJG7i96/GjdTm0f2kB/7a6iRedqzKruQ1otR
jRFRSwPfV9B6squRHxC/tKflEvU1SA30ba9OraK+BtGhL49kzbJRX4O1A4/n
yNeS7Rosz9tb2rblGvW1+Dm7MzpRRusdWshq1HfNP2qor0WxtyI48zX9b+xa
hMo05/r63aZ+DM5ZS6zKlTepH4PrcdvC5f3JxhikdV4Mc4ug8ewx+OzsF6BI
uEN9Hfwmte7VWul7hQ45xVeOmUfSfEYd5LUJLo+P0vXZdXDuyF1zapCD+rHo
yqjyEl5kxMLn1XP5MOUN6sfC6XTtgVvxZHss7rn2rLc6pPvXo0+SpfVg+WXq
6zFqqGqF7dlZ6uvxSHGhoDbdSn09zL5O7tmpZuob0HgwHbbIUuobILOUpHzd
mU99A4qGJfjmJWVQ3/D/ehBx/xvMRmY7s4jv9i8kkkJO
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, Automatic},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.504279814912985*^9, 3.5042798285630093`*^9}, {
   3.504279882211503*^9, 3.504279986263686*^9}, 3.5042801371346645`*^9, {
   3.50428038626213*^9, 3.5042804228441944`*^9}, 3.504280478473892*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"a2", "=", 
   RowBox[{"LCPiterate", "[", 
    RowBox[{"M2", ",", "q", ",", "z", ",", 
     RowBox[{"10", "^", 
      RowBox[{"-", "15"}]}], ",", "Infinity", ",", "PIM"}], "]"}]}], ";", 
  RowBox[{"a2", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", 
     RowBox[{"Min", "[", 
      RowBox[{"n", ",", "100"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.503867213703596*^9, 3.503867241437183*^9}, {
   3.5038676010297503`*^9, 3.50386760277285*^9}, {3.5038676424851217`*^9, 
   3.503867651148617*^9}, {3.5038682922132835`*^9, 3.503868293109335*^9}, {
   3.5038685025733156`*^9, 3.5038685501410365`*^9}, {3.5038686043501368`*^9, 
   3.503868607517318*^9}, {3.5038688797578893`*^9, 3.5038688841331396`*^9}, {
   3.5038690783652487`*^9, 3.5038690790212865`*^9}, {3.503869971045307*^9, 
   3.5038699734364443`*^9}, {3.5038700272935247`*^9, 3.503870052356958*^9}, {
   3.504199271732035*^9, 3.504199290483268*^9}, {3.5042642962247305`*^9, 
   3.5042642963527374`*^9}, {3.504264367576812*^9, 3.5042643707049904`*^9}, {
   3.5042644958651495`*^9, 3.5042644986483088`*^9}, {3.5042645326012506`*^9, 
   3.504264532712257*^9}, 3.504279931195589*^9, {3.5042799842668824`*^9, 
   3.5042799843448825`*^9}, {3.5042804821086984`*^9, 3.5042804821398983`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"LCP iteration\"\>"], "Print",
 CellChangeTimes->{
  3.5042798837715063`*^9, {3.504279918590767*^9, 3.5042799434572105`*^9}, {
   3.5042799813652773`*^9, 3.5042799845320826`*^9}, 3.5042801345606594`*^9, {
   3.504280479035493*^9, 3.504280482405099*^9}}],

Cell[BoxData["0.0470000000000006`"], "Print",
 CellChangeTimes->{
  3.5042798837715063`*^9, {3.504279918590767*^9, 3.5042799434572105`*^9}, {
   3.5042799813652773`*^9, 3.5042799845320826`*^9}, 3.5042801345606594`*^9, {
   3.504280479035493*^9, 3.5042804824362993`*^9}}],

Cell[BoxData["0.`"], "Print",
 CellChangeTimes->{
  3.5042798837715063`*^9, {3.504279918590767*^9, 3.5042799434572105`*^9}, {
   3.5042799813652773`*^9, 3.5042799845320826`*^9}, 3.5042801345606594`*^9, {
   3.504280479035493*^9, 3.5042804824362993`*^9}}],

Cell[BoxData["0.0470000000000006`"], "Print",
 CellChangeTimes->{
  3.5042798837715063`*^9, {3.504279918590767*^9, 3.5042799434572105`*^9}, {
   3.5042799813652773`*^9, 3.5042799845320826`*^9}, 3.5042801345606594`*^9, {
   3.504280479035493*^9, 3.5042804824362993`*^9}}],

Cell[BoxData["\<\"LCP iteration\"\>"], "Print",
 CellChangeTimes->{
  3.5042798837715063`*^9, {3.504279918590767*^9, 3.5042799434572105`*^9}, {
   3.5042799813652773`*^9, 3.5042799845320826`*^9}, 3.5042801345606594`*^9, {
   3.504280479035493*^9, 3.504280482451899*^9}}],

Cell[BoxData["0.030999999999998806`"], "Print",
 CellChangeTimes->{
  3.5042798837715063`*^9, {3.504279918590767*^9, 3.5042799434572105`*^9}, {
   3.5042799813652773`*^9, 3.5042799845320826`*^9}, 3.5042801345606594`*^9, {
   3.504280479035493*^9, 3.504280482467499*^9}}],

Cell[BoxData["0.`"], "Print",
 CellChangeTimes->{
  3.5042798837715063`*^9, {3.504279918590767*^9, 3.5042799434572105`*^9}, {
   3.5042799813652773`*^9, 3.5042799845320826`*^9}, 3.5042801345606594`*^9, {
   3.504280479035493*^9, 3.504280482467499*^9}}],

Cell[BoxData["0.030999999999998806`"], "Print",
 CellChangeTimes->{
  3.5042798837715063`*^9, {3.504279918590767*^9, 3.5042799434572105`*^9}, {
   3.5042799813652773`*^9, 3.5042799845320826`*^9}, 3.5042801345606594`*^9, {
   3.504280479035493*^9, 3.504280482467499*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.08912466241870165`", ",", "0.1273870186804904`", ",", 
   "0.206228180429431`", ",", "0.3040678156439859`", ",", 
   "0.3563521324600366`", ",", "0.30514524129933823`", ",", 
   "0.23677624333694267`", ",", "0.24931437562794026`", ",", 
   "0.316122131579991`", ",", "0.4076972873277394`", ",", 
   "0.46038306175774507`", ",", "0.4066348949950031`", ",", 
   "0.30515050916710257`", ",", "0.27575609252206346`", ",", 
   "0.31182058961892906`", ",", "0.3754627478571322`", ",", 
   "0.4179354676426604`", ",", "0.3792430172173151`", ",", 
   "0.28105101434897706`", ",", "0.22384154814600588`", ",", 
   "0.2253134507514168`", ",", "0.25057256955720575`", ",", 
   "0.26842184808381847`", ",", "0.24156248911149544`", ",", 
   "0.17136869795131235`", ",", "0.1145251186667218`", ",", 
   "0.09312360514101801`", ",", "0.08430458275987783`", ",", 
   "0.07233993418470826`", ",", "0.04725984234270874`", ",", 
   "0.014705063544471934`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.009551767241220342`", ",", 
   "0.028369935221558305`", ",", "0.04811503716640338`", ",", 
   "0.07310361912668425`", ",", "0.100326798471729`", ",", 
   "0.11883198800042798`", ",", "0.12209365327929085`", ",", 
   "0.12277302486297056`", ",", "0.13659306175502461`", ",", 
   "0.16416577154497955`", ",", "0.19527206398339567`", ",", 
   "0.21015861264488678`", ",", "0.19677861980928832`", ",", 
   "0.17499538541176707`", ",", "0.1723343462169336`", ",", 
   "0.1896694031183048`", ",", "0.21390202091429672`", ",", 
   "0.2241309345102933`", ",", "0.2040916223698201`", ",", 
   "0.16872657201345512`", ",", "0.14903764918550894`", ",", 
   "0.14962770405411863`", ",", "0.1581757133188061`", ",", 
   "0.15898985499128318`", ",", "0.13878450636563003`", ",", 
   "0.10427206002295021`", ",", "0.07757183241310318`", ",", 
   "0.06428209685613533`", ",", "0.05550790170727046`", ",", 
   "0.04353902494248067`", ",", "0.024909874985879387`", ",", 
   "0.005467020650093221`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5038685505880623`*^9, 3.5038686080853505`*^9, {3.503869075078061*^9, 
   3.5038691120421753`*^9}, {3.5038699747525196`*^9, 3.503869987314238*^9}, {
   3.5038700276965475`*^9, 3.5038700531460032`*^9}, 3.503870169740672*^9, 
   3.5041992909668694`*^9, 3.5042642988818827`*^9, {3.504264362687532*^9, 
   3.504264371954062*^9}, 3.504264418496724*^9, {3.504264456124876*^9, 
   3.5042644992663436`*^9}, 3.5042645343173485`*^9, 3.504264584582224*^9, {
   3.5042736836386595`*^9, 3.5042736933182135`*^9}, {3.5042738124020243`*^9, 
   3.504273829141982*^9}, 3.5042798482190437`*^9, 3.5042798844423075`*^9, {
   3.5042799241443768`*^9, 3.504279943550811*^9}, {3.5042799814588776`*^9, 
   3.5042799846256833`*^9}, 3.50428013466986*^9, {3.504280479113493*^9, 
   3.504280482467499*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LCPiterate", "[", 
    RowBox[{
    "M0_", ",", "a0_", ",", "b0_", ",", "c0_", ",", "q0_", ",", "x0_", ",", 
     "t0_", ",", "norm0_", ",", "LCPsolver_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"Iterative", " ", "MTA", " ", "Solver"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "=", "M0"}], ",", 
       RowBox[{"a", "=", "a0"}], ",", 
       RowBox[{"b", "=", "b0"}], ",", 
       RowBox[{"c", "=", "c0"}], ",", 
       RowBox[{"q", "=", "q0"}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "x0", "]"}]}], ",", 
       RowBox[{"norm", "=", "norm0"}], ",", 
       RowBox[{"x", "=", "x0"}], ",", 
       RowBox[{"tol", "=", "t0"}], ",", 
       RowBox[{"notDone", "=", "True"}], ",", 
       RowBox[{"d", "=", 
        RowBox[{
         RowBox[{"M0", ".", "x0"}], "-", "q0"}]}], ",", 
       RowBox[{"LCP", "=", "LCPsolver"}], ",", "i", ",", 
       RowBox[{"xm", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"notDone", "||", 
         RowBox[{
          RowBox[{"Min", "[", "d", "]"}], "<", 
          RowBox[{
           RowBox[{"-", "tol"}], " ", "xm"}]}], "||", 
         RowBox[{
          RowBox[{"Min", "[", "x", "]"}], "<", 
          RowBox[{
           RowBox[{"-", "tol"}], " ", "xm"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<LCP iteration\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Timing", "[", 
            RowBox[{
             RowBox[{"x", "=", 
              RowBox[{"LCPsolver", "[", 
               RowBox[{"a", ",", "b", ",", "c", ",", "q", ",", "x"}], "]"}]}],
              ";"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Check", " ", "for", " ", "termination"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{
           RowBox[{"M", ".", "x"}], "-", "q"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xm", "=", 
          RowBox[{"Norm", "[", 
           RowBox[{"x", ",", "norm"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"i", "=", "1"}], ";", 
         RowBox[{"notDone", "=", "False"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", "notDone"}], " ", "&&", 
            RowBox[{"i", "\[LessEqual]", "n"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"notDone", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", 
               RowBox[{"tol", " ", "xm"}]}], " ", "&&", 
              StyleBox[" ", "OperatorCharacter"], 
              RowBox[{
               RowBox[{
                StyleBox["Abs", "OperatorCharacter"], 
                StyleBox["[", "OperatorCharacter"], 
                StyleBox[
                 RowBox[{"x", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "OperatorCharacter"], "]"}],
                ">", 
               RowBox[{"tol", " ", "xm"}]}]}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"notDone", ",", 
                RowBox[{"Print", "[", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "/", "bm"}], ",", 
                   RowBox[{
                    RowBox[{
                    StyleBox["Abs", "OperatorCharacter"], 
                    StyleBox["[", "OperatorCharacter"], 
                    RowBox[{
                    StyleBox[
                    RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "OperatorCharacter"], "-", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/", " ", 
                    "cm"}]}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Min", "[", "d", "]"}], "/", "bm"}], ",", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"x", "-", "c"}], "]"}], "/", "cm"}]}], "}"}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"M", ".", "x"}], "-", "q"}], ",", "x"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.503872150306954*^9, 3.5038721691940346`*^9}, {
  3.5038722025459423`*^9, 3.5038722029209633`*^9}, {3.503872239178037*^9, 
  3.503872243761299*^9}, {3.503872284290618*^9, 3.5038722897619305`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MTA", "[", 
   RowBox[{"a0_", ",", "b0_", ",", "c0_", ",", "q0_", ",", "x0_"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{"MODIFIED_THOMAS", "_ALGORITHM"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Beta]", "=", "a0"}], ",", 
      RowBox[{"\[Alpha]", "=", "b0"}], ",", 
      RowBox[{"\[Gamma]", "=", "c0"}], ",", 
      RowBox[{"b", "=", "q0"}], ",", 
      RowBox[{"x", "=", "x0"}], ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x0", "]"}]}], ",", "i", ",", "k", ",", 
      "\[Lambda]"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Beta]", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "2", "]"}], "]"}], 
          RowBox[{"\[Gamma]", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "\[GreaterEqual]", " ", "0"}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ";", 
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], 
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Beta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], 
            RowBox[{"\[Gamma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "<", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Lambda]", "=", 
           RowBox[{
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", 
            RowBox[{"\[Beta]", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-=", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"\[Gamma]", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"b", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-=", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"b", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ";", 
          RowBox[{
           RowBox[{"b", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "n", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "n", "]"}], "]"}], "/", 
       RowBox[{"a", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", 
           RowBox[{
            RowBox[{"c", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"a", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5038722108624177`*^9, 3.503872215182665*^9}, {
  3.5038722465984616`*^9, 3.5038722601582375`*^9}, {3.5038723180145464`*^9, 
  3.5038723183825674`*^9}, {3.5038723514784603`*^9, 3.5038724567284803`*^9}, {
  3.503872492936551*^9, 3.50387253138675*^9}, {3.5038727190904865`*^9, 
  3.503872986577786*^9}}]
},
WindowSize->{759, 932},
WindowMargins->{{74, Automatic}, {Automatic, 66}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 2748, 70, 152, "Input"],
Cell[3308, 92, 6254, 146, 492, "Input"],
Cell[9565, 240, 6161, 113, 372, "Input"],
Cell[15729, 355, 1511, 47, 112, "Input"],
Cell[CellGroupData[{
Cell[17265, 406, 3495, 95, 172, "Input"],
Cell[20763, 503, 242, 3, 30, "Output"],
Cell[21008, 508, 242, 3, 30, "Output"],
Cell[21253, 513, 1101, 21, 237, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22391, 539, 2003, 55, 72, "Input"],
Cell[24397, 596, 77, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24511, 602, 447, 10, 31, "Input"],
Cell[24961, 614, 2508, 45, 240, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27506, 664, 1288, 23, 31, "Input"],
Cell[CellGroupData[{
Cell[28819, 691, 270, 4, 23, "Print"],
Cell[29092, 697, 270, 4, 23, "Print"],
Cell[29365, 703, 254, 4, 23, "Print"],
Cell[29622, 709, 270, 4, 23, "Print"],
Cell[29895, 715, 270, 4, 23, "Print"],
Cell[30168, 721, 270, 4, 23, "Print"],
Cell[30441, 727, 252, 4, 23, "Print"],
Cell[30696, 733, 270, 4, 23, "Print"]
}, Open  ]],
Cell[30981, 740, 3259, 52, 183, "Output"]
}, Open  ]],
Cell[34255, 795, 5475, 136, 472, "Input"],
Cell[39733, 933, 5352, 146, 312, "Input"]
}
]
*)

(* End of internal cache information *)

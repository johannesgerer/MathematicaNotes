(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     16204,        382]
NotebookOptionsPosition[     15041,        344]
NotebookOutlinePosition[     15600,        363]
CellTagsIndexPosition[     15557,        360]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Exit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.4716710206984625`*^9, 3.471671022352065*^9}, {
  3.4723174540741167`*^9, 3.472317454230117*^9}, {3.4723175178158283`*^9, 
  3.4723175201090326`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["s"], "Input",
 CellChangeTimes->{{3.4723178959790926`*^9, 3.4723179010803013`*^9}, {
   3.472318012121297*^9, 3.4723180182989073`*^9}, {3.4723190401859226`*^9, 
   3.472319040279523*^9}, {3.4725458014992533`*^9, 3.472545804269257*^9}, 
   3.472545951991465*^9, {3.4725460021315355`*^9, 3.472546139387734*^9}, {
   3.472546171367779*^9, 3.472546173657782*^9}, {3.472546325204028*^9, 
   3.4725463773141007`*^9}, {3.4725469570049524`*^9, 3.472546957734954*^9}, {
   3.472547109839172*^9, 3.472547112049175*^9}, {3.472547336286742*^9, 
   3.4725473379715447`*^9}, {3.4725484928542037`*^9, 3.472548529404255*^9}, {
   3.4725486029655027`*^9, 3.4725486208779078`*^9}, {3.472548676119986*^9, 
   3.4725486762499866`*^9}, {3.472548745784088*^9, 3.4725487468740892`*^9}, {
   3.4725488598242474`*^9, 3.4725488599542475`*^9}, {3.472548952017378*^9, 
   3.4725489561273837`*^9}, 3.472555801940077*^9}],

Cell[BoxData[
 FractionBox["1", "59"]], "Output",
 CellChangeTimes->{{3.4725463365340433`*^9, 3.472546377624101*^9}, 
   3.4725465894204082`*^9, 3.47254708828714*^9, 3.472547128419198*^9, 
   3.4725472853058524`*^9, 3.472547339266347*^9, 3.472547951208622*^9, {
   3.4725484930242043`*^9, 3.4725485295442553`*^9}, {3.472548603475504*^9, 
   3.4725486215379086`*^9}, 3.472548676679987*^9, 3.4725487136540427`*^9, 
   3.4725487471740894`*^9, 3.472548860294248*^9}],

Cell[BoxData["3420"], "Output",
 CellChangeTimes->{{3.4725463365340433`*^9, 3.472546377624101*^9}, 
   3.4725465894204082`*^9, 3.47254708828714*^9, 3.472547128419198*^9, 
   3.4725472853058524`*^9, 3.472547339266347*^9, 3.472547951208622*^9, {
   3.4725484930242043`*^9, 3.4725485295442553`*^9}, {3.472548603475504*^9, 
   3.4725486215379086`*^9}, 3.472548676679987*^9, 3.4725487136540427`*^9, 
   3.4725487471740894`*^9, 3.472548860294248*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.4725489621473923`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P0", "=", "0"}], ";", 
  RowBox[{"S0", "=", "100"}], ";", 
  RowBox[{"\[Sigma]", "=", "0.2"}], ";", 
  RowBox[{"r", "=", "0.0"}], ";", 
  RowBox[{"T", "=", "0.5"}], ";", 
  RowBox[{"K", "=", "7000000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nt", "=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{"K", "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "3"}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dt", "=", 
  RowBox[{"N", "[", 
   RowBox[{"T", "/", "nt"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", 
    RowBox[{"Ceiling", "[", 
     RowBox[{"K", "^", 
      RowBox[{"(", 
       RowBox[{"2", "/", "3"}], ")"}]}], "]"}]}], ";", 
   RowBox[{"N", "[", 
    RowBox[{"n", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], ")"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PE", "=", "0"}], ";", 
   RowBox[{"PV", "=", "0"}], ";", 
   RowBox[{"lP", "=", 
    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dW", "=", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", "]"}], ",", 
          RowBox[{"{", "nt", "}"}]}], "]"}], "/", 
        RowBox[{"Sqrt", "[", "nt", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"W", "=", "0"}], ";", 
      RowBox[{"P", "=", "P0"}], ";", 
      RowBox[{"S", "=", "S0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", 
         RowBox[{"nt", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"W", "+=", 
          RowBox[{"dW", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dS", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "^", "2"}], "/", "2"}]}], ")"}], " ", 
               "i", " ", "dt"}], "+", 
              RowBox[{"\[Sigma]", " ", "W"}]}], "]"}], "*", "S0"}], "-", 
           "S"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"P", "+=", 
          RowBox[{
           RowBox[{"r", " ", "P", " ", "dt"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               RowBox[{"UnitStep", "[", "P", "]"}]}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"dS", "-", 
              RowBox[{"r", " ", "S", " ", "dt"}]}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"S", "+=", "dS"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PE", "+=", 
       RowBox[{"Max", "[", 
        RowBox[{"P", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PV", "+=", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"P", ",", "0"}], "]"}], "^", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"lP", ",", 
        RowBox[{"Max", "[", 
         RowBox[{"P", ",", "0"}], "]"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", "n", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\"\<Mean:\>\"", ",", " ", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "r"}], " ", "T"}], "]"}], 
      RowBox[{"PE", "/", "n"}]}], ",", "\"\<2 StD of Mean:\>\"", ",", 
     RowBox[{"2", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "2"}], "r", " ", "T"}], "]"}], "/", "n"}], "/", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{"PV", "-", 
          RowBox[{
           RowBox[{"PE", "^", "2"}], "/", "n"}]}], ")"}]}], "]"}]}]}], 
    "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.471765140545*^9, {3.4717652058934*^9, 3.4717652315086*^9}, {
   3.4717652847046003`*^9, 3.4717653493822002`*^9}, 3.471765561745*^9, {
   3.4717656313834*^9, 3.4717656394954*^9}, 3.4717675251142*^9, {
   3.471767761657*^9, 3.4717677894406*^9}, {3.4723174015488243`*^9, 
   3.4723174307988753`*^9}, 3.4723174612501287`*^9, {3.4723177826916933`*^9, 
   3.472317805966934*^9}, 3.4723180007332764`*^9, {3.4723182119108477`*^9, 
   3.4723182345776873`*^9}, {3.472318788994282*^9, 3.472318815904329*^9}, {
   3.4723188488671865`*^9, 3.472318861581209*^9}, {3.4723189436685534`*^9, 
   3.4723189921378384`*^9}, {3.4723190908080115`*^9, 
   3.4723192159514313`*^9}, {3.472319262439513*^9, 3.472319276401538*^9}, {
   3.4723193379280453`*^9, 3.4723193402056494`*^9}, {3.4723193857733297`*^9, 
   3.472319473117883*^9}, 3.472319565329645*^9, 3.472319780781624*^9, {
   3.4723201318768406`*^9, 3.4723201789577227`*^9}, 3.4725459512414637`*^9, 
   3.472545981801507*^9, {3.4725462021858335`*^9, 3.472546237869897*^9}, {
   3.472546308074004*^9, 3.4725463195840197`*^9}, {3.472546396234127*^9, 
   3.472546427654171*^9}, {3.4725464675942273`*^9, 3.4725464999442725`*^9}, {
   3.4725465672583723`*^9, 3.4725465700383763`*^9}, {3.4725466309844856`*^9, 
   3.4725466344944906`*^9}, {3.4725466665845356`*^9, 3.472546667064536*^9}, {
   3.47254669822458*^9, 3.4725467180646076`*^9}, {3.472546749254651*^9, 
   3.4725470604471006`*^9}, {3.472547095709152*^9, 3.47254712274919*^9}, {
   3.47254724385658*^9, 3.472547255837401*^9}, 3.4725472877706566`*^9, {
   3.4725473289703293`*^9, 3.4725473603419843`*^9}, {3.47254739782885*^9, 
   3.472547461180561*^9}, {3.472547539742299*^9, 3.4725475411463017`*^9}, {
   3.4725481326136913`*^9, 3.472548192485777*^9}, {3.4725482625958757`*^9, 
   3.4725482811559014`*^9}, {3.4725483374659805`*^9, 
   3.4725483503459983`*^9}, {3.4725483825860434`*^9, 3.472548400376068*^9}, {
   3.4725484318341184`*^9, 3.4725484817541885`*^9}, {3.4725487806441364`*^9, 
   3.472548838064217*^9}, {3.4725488721442647`*^9, 3.472548914137325*^9}, {
   3.4725489579673862`*^9, 3.472549005967453*^9}, {3.472549047817512*^9, 
   3.4725492193938036`*^9}, {3.472549321285949*^9, 3.472549428016099*^9}, {
   3.4725495242962337`*^9, 3.472549535316249*^9}, {3.4725495670062933`*^9, 
   3.4725495778283095`*^9}, {3.4725496485984087`*^9, 
   3.4725496647684317`*^9}, {3.472549709988495*^9, 3.4725497404105387`*^9}, 
   3.47254978479661*^9, {3.4725498387966857`*^9, 3.4725499195816035`*^9}, {
   3.4725500076145287`*^9, 3.472550104766666*^9}, {3.47255015075673*^9, 
   3.4725501556567373`*^9}, {3.472550254116875*^9, 3.4725502543068757`*^9}, {
   3.4725503344130096`*^9, 3.472550362053048*^9}, {3.4725503975511065`*^9, 
   3.4725504997212496`*^9}, {3.4725505313033047`*^9, 3.472550534743309*^9}, 
   3.4725506096334143`*^9, {3.4725508123246975`*^9, 3.4725508164047036`*^9}, {
   3.472550849164749*^9, 3.472550864046771*^9}, {3.4725509796869335`*^9, 
   3.4725510071229815`*^9}, {3.472551186491358*^9, 3.4725512193514037`*^9}, 
   3.4725513320755825`*^9, {3.4725513816356525`*^9, 3.472551434555726*^9}, {
   3.4725515304014645`*^9, 3.472551615787592*^9}, {3.4725517115597286`*^9, 
   3.4725517125797305`*^9}, {3.4725518322298975`*^9, 3.472551832379898*^9}, 
   3.472551975950099*^9, {3.4725522030514283`*^9, 3.4725522285194893`*^9}, {
   3.4725523927617216`*^9, 3.4725524274917707`*^9}, {3.472552472301833*^9, 
   3.472552490061858*^9}, {3.4725526512620835`*^9, 3.4725526520220847`*^9}, {
   3.4725529047204466`*^9, 3.4725530124426003`*^9}, 3.472553044522645*^9, {
   3.4725531679488525`*^9, 3.472553192022889*^9}, {3.4725549048843756`*^9, 
   3.4725549382804327`*^9}, {3.4725554475674896`*^9, 3.4725554477174892`*^9}}],

Cell[BoxData["0.0026041666666666665`"], "Output",
 CellChangeTimes->{{3.47255098568095*^9, 3.472551007582982*^9}, {
   3.4725511970813723`*^9, 3.472551219591404*^9}, 3.472551342575598*^9, {
   3.4725513918756666`*^9, 3.4725514348157263`*^9}, {3.4725515878575525`*^9, 
   3.4725516160575924`*^9}, 3.472551713849732*^9, 3.472551832879899*^9, 
   3.472551977120101*^9, {3.4725522094414372`*^9, 3.4725522328794956`*^9}, 
   3.472552427791771*^9, {3.472552476261839*^9, 3.4725524940018635`*^9}, 
   3.4725526697721095`*^9, 3.4725529467125077`*^9, 3.4725529768025503`*^9, 
   3.4725530126726003`*^9, 3.4725530447026453`*^9, {3.4725531707588563`*^9, 
   3.472553192182889*^9}, 3.472554771184189*^9, {3.4725549109743843`*^9, 
   3.472554938680433*^9}}],

Cell[BoxData["0.0052275122370650465`"], "Output",
 CellChangeTimes->{{3.47255098568095*^9, 3.472551007582982*^9}, {
   3.4725511970813723`*^9, 3.472551219591404*^9}, 3.472551342575598*^9, {
   3.4725513918756666`*^9, 3.4725514348157263`*^9}, {3.4725515878575525`*^9, 
   3.4725516160575924`*^9}, 3.472551713849732*^9, 3.472551832879899*^9, 
   3.472551977120101*^9, {3.4725522094414372`*^9, 3.4725522328794956`*^9}, 
   3.472552427791771*^9, {3.472552476261839*^9, 3.4725524940018635`*^9}, 
   3.4725526697721095`*^9, 3.4725529467125077`*^9, 3.4725529768025503`*^9, 
   3.4725530126726003`*^9, 3.4725530447026453`*^9, {3.4725531707588563`*^9, 
   3.472553192182889*^9}, 3.472554771184189*^9, {3.4725549109743843`*^9, 
   3.4725549386904325`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"98.873`", ",", 
   RowBox[{"{", 
    RowBox[{"\<\"r:\"\>", ",", "0.`", ",", "\<\"Mean:\"\>", ",", 
     "8.431886805623728`", ",", "\<\"2 StD of Mean:\"\>", ",", 
     "0.11889207771333099`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.47255098568095*^9, 3.472551007582982*^9}, {
   3.4725511970813723`*^9, 3.472551219591404*^9}, 3.472551342575598*^9, {
   3.4725513918756666`*^9, 3.4725514348157263`*^9}, {3.4725515878575525`*^9, 
   3.4725516160575924`*^9}, 3.472551713849732*^9, 3.472551832879899*^9, 
   3.472551977120101*^9, {3.4725522094414372`*^9, 3.4725522328794956`*^9}, 
   3.472552427791771*^9, {3.472552476261839*^9, 3.4725524940018635`*^9}, 
   3.4725526697721095`*^9, 3.4725529467125077`*^9, 3.4725529768025503`*^9, 
   3.4725530126726003`*^9, 3.4725530447026453`*^9, {3.4725531707588563`*^9, 
   3.472553192182889*^9}, 3.472554771184189*^9, 3.4725549109743843`*^9, 
   3.4725550380328984`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"9.70299999999986`", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<r:\>\"", ",", "0.`", ",", "\"\<Mean:\>\"", ",", 
      "8.283546638322484`", ",", "\"\<2 StD of Mean:\>\"", ",", 
      "0.2529243696071112`"}], "}"}]}], "}"}], " "}]], "Input",
 CellChangeTimes->{{3.472553040512639*^9, 3.4725530405226393`*^9}}],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"{", 
   RowBox[{"10.435999999999922`", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Mean in %:\>\"", ",", "8.21466833216132`", ",", 
      "\"\<2 StD of Mean:\>\"", ",", "0.25043002273258974`"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{3.4725509822369366`*^9, 3.4725524921718607`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PE", "/", "n"}], "/", "S0"}], "*", "100"}]], "Input"],

Cell[BoxData["20.26326588814293`"], "Output",
 CellChangeTimes->{3.4725505462933254`*^9, 3.4725506893535256`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.896999999999991`", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Mean in %:\>\"", ",", "15.653555705091257`", ",", 
     "\"\<2 StD of Mean:\>\"", ",", "1.257801821071628`"}], "}"}]}], 
  "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.850000000000023`", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Mean in %:\>\"", ",", "8.135967442770141`", ",", 
     "\"\<2 StD of Mean:\>\"", ",", "0.8236934394048495`"}], "}"}]}], 
  "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.9879999999999995`", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Mean:\>\"", ",", "0.1515643123601304`", ",", "\"\<StD of Mean:\>\"", 
     ",", "0.0025561886989783696`"}], "}"}]}], "}"}]], "Input"]
},
WindowSize->{784, 991},
WindowMargins->{{Automatic, -13}, {Automatic, 29}},
FrontEndVersion->"7.0 for Microsoft Windows (64-bit) (November 10, 2008)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "7.0 for Microsoft Windows (64-bit) (November 10, 2008)",
   StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 224, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[794, 28, 905, 12, 31, "Input"],
Cell[1702, 42, 462, 7, 47, "Output"],
Cell[2167, 51, 444, 6, 30, "Output"]
}, Open  ]],
Cell[2626, 60, 70, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[2721, 65, 8148, 175, 552, "Input"],
Cell[10872, 242, 744, 10, 30, "Output"],
Cell[11619, 254, 746, 10, 30, "Output"],
Cell[12368, 266, 955, 16, 30, "Output"]
}, Open  ]],
Cell[13338, 285, 365, 9, 52, InheritFromParent],
Cell[13706, 296, 339, 9, 52, "Input"],
Cell[CellGroupData[{
Cell[14070, 309, 100, 3, 31, "Input"],
Cell[14173, 314, 113, 1, 30, "Output"]
}, Open  ]],
Cell[14301, 318, 245, 7, 31, "Input"],
Cell[14549, 327, 245, 7, 31, "Input"],
Cell[14797, 336, 240, 6, 31, "Input"]
}
]
*)

(* End of internal cache information *)
